<!DOCTYPE html>
<html>
    <head>
        <title>Karen's Notes</title>
        <meta charset="UTF-8"/> 
        <link rel="stylesheet" type="text/css" href="node_modules/bootstrap/dist/css/bootstrap.css"/>
        <link rel="stylesheet" type="text/css" href="index.css" />
        <script src="index.js"></script>
        <script src="controller.js"></script>
        <script src="model.js"></script>
    </head>
    <body>
        <h1>Note Takeing App.</h1>

        <b>What am I looking at?!</b>
        <p>Well silly! You are looking at my note taking application. Start writing a name for your note in the top input box, write the content in the space below that then click save. This will make it appear on the right within a sorta-post-it-note. If you want to edit what a sorta-post-it-note, click on it - which will make it appear in the input areas - and then click on Edit when you are done making changes. If you hate all your notes click on clear. If you hate one note, then click on it then erase the contents and click Edit. If the status says you can save, then the notes will save to your browser when you exit. If you feel super paranoid, you can click on "like save" to manually store them. If you cannot save them to your browser, you can use the export feature to save them to your computer in a csv file. And finally, you can search your sorta-post-it-notes using the date and keyword search on the right.</p>
        <div id="insertData">
            <p>Name:</p>
            <input id="name" name="name" type="text"></input>
            <p>Description:</p>
            <textarea cols=60 rows=15 id="description"  name="description" type="text"></textarea>
            <p>and finally</p>

            <input type=submit value="Save" id="save" />
            <input type=submit value="Clear" id="clear" />
            <input type=submit value="Export" id="export"/>       
            <input type=submit value="Store!" id="store"/>       
            <input type=submit value="Edit" id="edit" disabled=true />       
            <input type=submit value="Remove" id="remove" disabled=true />       
        </div>

        <div id="displayData">

            <b>Status:</b> <p id="status"> </p>

            <input type=date name="date" id="date" value="2016-10-11" ></input>
            <input type=text name="keyword" id = "keyword"></input>
            <input type=submit name="query" value="Query" id="query"></input>
            <input type=submit name="reset" value="Reset" id="reset"></input>
            <div id="notes"> 
            </div>

        </div>
        <script >

startApp();
console.log("started");

window.onbeforeunload = function(e) {
    note.saveDataToLocalStorage();
}
        </script>

        <script>
document.getElementById("save").onclick = function() {
    saveData(document.getElementById('name'), document.getElementById('description'))
}
document.getElementById("reset").onclick = function() {
    display();
}
document.getElementById("remove").onclick = function() {
    var i = document.getElementById('edit').className;
    var id = parseInt(i);
    notenotes[id].removeNote();
    document.getElementById('edit').disabled = true;
    document.getElementById('remove').disabled = true;
    display();
}


document.getElementById("edit").onclick = function() {
    var id = parseInt(this.className);
    var newHeading = document.getElementById('name').value;
    var newDescription = document.getElementById('description').value;
    editData(id, newHeading, newDescription);
    document.getElementById('edit').disabled = true;
    document.getElementById('remove').disabled = true;
    display();
}

document.getElementById("store").onclick = function() {
    note.saveDataToLocalStorage();
    alert("Saved to local storage")
}
document.getElementById("clear").onclick =  function() {
    clearData();
}
document.getElementById("export").onclick = function() {
    exportData();
}
document.getElementById("query").onclick = function() {
    queryData(document.getElementById('date'), document.getElementById('keyword'))

}

function unclickAllNotes(){
    var notes = document.getElementById("notes").childNodes;
    for (var i=0; i<notes.length; i++ ){
        notes[i].className = "note unClicked";
    }
    return true;
}

document.getElementById("notes").onclick = function(e){
    console.log(this);
    console.log(e);
    var t = e.target;

    while (t.className.indexOf("note") == -1 && t !== document.body) {

        console.log(t);
        t = t.parentElement;

    }
    if (t == document.body){
        alert("Please click on a note to edit it.");

    }
    else {
        unclickAllNotes();
        t.className = "note clicked";

        var id = parseInt(t.id);
        console.log(notenotes[id]);
        document.getElementById('name').value = notenotes[id].heading;

        document.getElementById('description').value = notenotes[id].description;
        document.getElementById('edit').disabled = false;
        document.getElementById('edit').className = id;
        document.getElementById('remove').disabled = false;
    }
}
        </script>
    </body>

</html>


